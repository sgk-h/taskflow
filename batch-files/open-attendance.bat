@echo off
REM =====================================================
REM ファイル名: open-attendance.bat
REM 説明: Windows スタートアップで勤怠管理システムを自動表示
REM 機能:
REM   - 勤怠管理システムのURLをブラウザで自動開く
REM   - ログイン時間を表示
REM   - コマンドプロンプトウィンドウを保持
REM 作成日: 2025-12-07
REM =====================================================

REM =====================================================
REM 【編集】以下のURLを貴社の勤怠管理システムURLに置き換えてください
REM =====================================================
set ATTENDANCE_URL=https://company.example.com/attendance

REM =====================================================
REM 初期化処理
REM =====================================================
setlocal enabledelayedexpansion
chcp 65001 > nul
color 0F
title 勤怠管理システム自動起動

REM =====================================================
REM メイン処理開始
REM =====================================================
cls
call :SHOW_HEADER
call :SHOW_LOGIN_INFO
call :OPEN_BROWSER
call :SHOW_FOOTER
pause
exit /b

REM =====================================================
REM ヘッダー表示サブルーチン
REM =====================================================
:SHOW_HEADER
echo.
echo =====================================
echo   勤怠管理システム自動起動
echo =====================================
echo.
echo 【ログイン情報】
exit /b

REM =====================================================
REM ログイン情報取得・表示サブルーチン
REM =====================================================
:SHOW_LOGIN_INFO
query user
if errorlevel 1 (
    echo.
    echo エラー: ユーザー情報の取得に失敗しました
    goto :EOF
)
exit /b

REM =====================================================
REM ブラウザ起動サブルーチン
REM =====================================================
:OPEN_BROWSER
echo.
echo 【ブラウザ起動】

REM URL未設定チェック
if "%ATTENDANCE_URL%"=="" (
    echo エラー: URLが指定されていません。
    echo バッチファイルを編集して、ATTENDANCE_URLを設定してください。
    exit /b
)

echo ブラウザで以下のURLを開いています...
echo %ATTENDANCE_URL%
echo.

start "" %ATTENDANCE_URL%

if errorlevel 1 (
    echo 警告: ブラウザの起動に失敗しました。
    echo 手動で上記のURLをブラウザで開いてください。
) else (
    echo ✓ ブラウザが起動しました
)

exit /b

REM =====================================================
REM フッター表示サブルーチン
REM =====================================================
:SHOW_FOOTER
echo.
echo =====================================
echo [Enterキーを押してこのウィンドウを閉じてください]
echo =====================================
echo.
exit /b
