# 勤怠管理システム自動起動バッチ ユーザーマニュアル

## はじめに

このマニュアルは、`open-attendance.bat`バッチファイルの使用方法、トラブルシューティング、カスタマイズ方法について説明します。

---

## 目次

1. [システム概要](#システム概要)
2. [セットアップ（初回設定）](#セットアップ初回設定)
3. [使用方法](#使用方法)
4. [トラブルシューティング](#トラブルシューティング)
5. [カスタマイズ](#カスタマイズ)
6. [FAQ](#faq)
7. [サポート情報](#サポート情報)

---

## システム概要

### 概要

`open-attendance.bat`は、Windows起動時に自動的に勤怠管理システムのウェブサイトをブラウザで開くバッチファイルです。同時にログイン時間をコマンドプロンプトに表示します。

### 主な機能

| 機能 | 説明 |
|------|------|
| **自動起動** | Windows起動後、自動的にバッチが実行される |
| **ブラウザ自動開始** | 勤怠管理システムのURLを既定ブラウザで開く |
| **ログイン情報表示** | 現在のユーザーのログイン時間を表示 |
| **画面保持** | Enter キー押下まで情報を画面に表示 |

### 利点

- **打ち忘れ防止**: 起動時に強制的に勤怠管理システムが表示される
- **手間削減**: URLを手動でブラウザに入力する手間がない
- **ログイン情報確認**: 端末へのログイン時間を即座に把握できる

---

## セットアップ（初回設定）

### 必要な環境

| 要件 | 詳細 |
|------|------|
| **OS** | Windows 10 / Windows 11 |
| **ブラウザ** | Internet Explorer、Edge、Chrome 等（既定ブラウザが設定されていること） |
| **ネットワーク** | インターネット接続（勤怠管理システムアクセス用） |
| **権限** | 通常ユーザー権限（管理者権限不要） |

### セットアップ手順

#### ステップ1: ファイルの受け取り

IT部門から`open-attendance.bat`ファイルを受け取ります

#### ステップ2: URL設定（重要）

1. `open-attendance.bat`をメモ帳（テキストエディタ）で開きます
2. 16行目の以下の部分を探します：
   ```batch
   set ATTENDANCE_URL=https://company.example.com/attendance
   ```
3. `https://company.example.com/attendance`の部分を、貴社の勤怠管理システムのURLに置き換えます
   - **例1:** `set ATTENDANCE_URL=https://hr.company.jp/kintai`
   - **例2:** `set ATTENDANCE_URL=https://attendance.internal.com`
4. ファイルを保存します（**Shift-JIS形式推奨**）

#### ステップ3: スタートアップフォルダに配置

1. `Win + R`キーを押して「ファイル名を指定して実行」ダイアログを開きます
2. `shell:startup`と入力して**Enter**キーを押します
3. スタートアップフォルダが開きます
4. `open-attendance.bat`ファイルをこのフォルダにコピーします（ドラッグ&ドロップまたはCtrl+C→Ctrl+V）
5. フォルダを閉じます

#### ステップ4: 動作確認

1. `open-attendance.bat`をダブルクリックして実行します
2. 以下の画面が表示されることを確認します：
   ```
   =====================================
     勤怠管理システム自動起動
   =====================================
   
   【ログイン情報】
   USERNAME      SESSIONNAME    ID  STATE
   {あなたのユーザー名}  console    0   アクティブ
   
   【ブラウザ起動】
   ブラウザで以下のURLを開いています...
   https://hr.company.jp/kintai
   
   ✓ ブラウザが起動しました
   
   =====================================
   [Enterキーを押してこのウィンドウを閉じてください]
   =====================================
   ```
3. ブラウザで勤怠管理システムが開いていることを確認します
4. **Enter**キーを押してコマンドプロンプトを閉じます

#### ステップ5: 自動実行の確認

1. **Windowsを再起動**します
2. ログイン後、**自動的にコマンドプロンプトが起動**し、バッチが実行されることを確認します
3. ブラウザが自動で勤怠管理システムを開いていることを確認します

---

## 使用方法

### 通常の使い方

1. **毎日の起動時：**
   - Windows起動 → ログイン → 自動的にバッチが実行
   - コマンドプロンプトに現在のログイン時間が表示される
   - ブラウザが勤怠管理システムを自動で開く

2. **手動実行：**
   - 日中に再度勤怠管理システムを表示したい場合
   - `open-attendance.bat`をダブルクリックで実行

### 表示内容の理解

```
USERNAME      SESSIONNAME    ID  STATE       IDLE TIME
user01        console        0   アクティブ   15
```

| 項目 | 説明 |
|------|------|
| **USERNAME** | ログインしているユーザー名 |
| **SESSIONNAME** | セッション名（通常は console） |
| **ID** | セッションID（通常は 0） |
| **STATE** | セッション状態（アクティブ/切断） |
| **IDLE TIME** | 最後の操作からの経過時間（分） |

---

## トラブルシューティング

### よくあるトラブルと対応方法

#### 問題1: 「ユーザー情報の取得に失敗しました」と表示される

**症状:**
```
エラー: ユーザー情報の取得に失敗しました
```

**原因:**
- Windows設定の権限に関する問題
- ドメイン参加環境での権限不足

**対応:**
1. **通常ユーザーの場合：**
   - Windowsを再起動してもう一度実行してみる
   
2. **ドメイン参加環境の場合：**
   - IT部門に連絡し、グループポリシーの確認を依頼

3. **それでも解決しない場合：**
   - IT部門のサポート（連絡先：[サポート情報](#サポート情報)参照）

---

#### 問題2: ブラウザが起動しない

**症状:**
```
警告: ブラウザの起動に失敗しました。
手動で上記のURLをブラウザで開いてください。
```

**原因:**
- デフォルトブラウザが設定されていない
- URLの設定が間違っている
- ネットワークに接続していない

**対応:**

1. **デフォルトブラウザの確認と設定：**
   - 「Windowsメニュー」→「設定」を開く
   - 「アプリ」→「デフォルトアプリ」を選択
   - 「ブラウザ」の項目を確認し、希望のブラウザ（Chrome、Edge等）を選択
   - 「アプリを開く」で実際にブラウザが起動するか確認

2. **URLの確認：**
   - `open-attendance.bat`をメモ帳で開く
   - 16行目の`ATTENDANCE_URL`を確認
   - URLが正しいか確認（例：`https://`で始まっているか）

3. **ネットワーク接続の確認：**
   - ブラウザを手動で開く
   - インターネットサイト（例：https://www.google.com）にアクセスできるか確認
   - 接続できない場合は、Wi-Fiまたは有線LANを確認

4. **ブラウザのインストール確認：**
   - Chromeなど別のブラウザがインストール済みか確認
   - インストールされていない場合は、IT部門に依頼

---

#### 問題3: 日本語が文字化けして表示される

**症状:**
```
勤怠管理シ「ステ「ム自勤勤起動
```

**原因:**
- バッチファイルの文字コード設定が間違っている

**対応:**

1. バッチファイルをメモ帳で開く
2. 「ファイル」→「名前を付けて保存」をクリック
3. ダイアログ下部の「文字コード」を確認
4. 以下のいずれかに変更して保存：
   - **Shift-JIS**（推奨、Windows標準）
   - UTF-8 with BOM
5. バッチを再度実行

※ Visual Studio Code等の高度なエディタを使用している場合は、右下の文字コード表示をクリックして変更してください

---

#### 問題4: スタートアップ時に自動実行されない

**症状:**
- Windowsを再起動しても、バッチが自動実行されない

**原因:**
- ファイルがスタートアップフォルダに正しく配置されていない
- ファイル名が変更されている
- スタートアップが無効化されている

**対応:**

1. **スタートアップフォルダの確認：**
   - `Win + R` → `shell:startup` → **Enter**
   - スタートアップフォルダが開く
   - `open-attendance.bat`ファイルが存在するか確認
   
2. **ファイル名の確認：**
   - ファイル名が`open-attendance.bat`のままか確認
   - 名前が変更されている場合は、元に戻す

3. **スタートアップの有効化確認：**
   - 「Windowsメニュー」→「設定」→「アプリ」→「スタートアップ」
   - スタートアップが「有効」になっているか確認
   - 「有効」に変更

4. **タスクスケジューラでの確認（上級）：**
   - `Win + R` → `taskschd.msc` → **Enter**
   - スタートアップフォルダのファイルがタスク登録されているか確認

---

#### 問題5: Enterキーを押してもコマンドプロンプトが閉じない

**症状:**
- Enterキーを押しても画面が黒いままで閉じない

**原因:**
- ウィンドウが別のプロセスで実行中
- 予期しないエラー

**対応:**

1. **Ctrl+C**キーを押して、強制終了する
2. バッチを再度実行

それでも解決しない場合は、IT部門に連絡してください

---

### 高度なトラブルシューティング

#### イベントビューアで詳細を確認

Windows管理者権限がある場合：

1. `Win + R` → `eventvwr` → **Enter**
2. 「Windowsログ」→「システム」を開く
3. エラーを探し、詳細を確認

---

## カスタマイズ

### URL を変更したい

**現在のURL：**
```batch
set ATTENDANCE_URL=https://company.example.com/attendance
```

**変更方法：**
1. バッチファイルをメモ帳で開く
2. 上記の`https://company.example.com/attendance`部分をシステム管理者から提供される新しいURLに置き換え
3. 保存

**例：**
```batch
set ATTENDANCE_URL=https://hr.new-system.jp/kintai-kanri
```

---

### バッチが自動起動しないようにしたい

1. `Win + R` → `shell:startup` → **Enter**
2. スタートアップフォルダから`open-attendance.bat`ファイルを削除
3. 再起動後、自動実行されなくなります

再度有効化したい場合は、[セットアップステップ3](#ステップ3スタートアップフォルダに配置)を実行してください

---

### ブラウザウィンドウのサイズを指定したい

**最大化で起動する場合：**
1. バッチファイルをメモ帳で開く
2. 以下の行を探す：
   ```batch
   start "" %ATTENDANCE_URL%
   ```
3. 以下に変更：
   ```batch
   start "" /max %ATTENDANCE_URL%
   ```
4. 保存

**最小化で起動する場合：**
```batch
start "" /min %ATTENDANCE_URL%
```

---

## FAQ

### Q1: 勤怠入力を忘れた場合はどうする？

**A:** 手動で勤怠管理システムを開いて入力してください。コマンドプロンプトが起動しない場合：
1. 既定ブラウザを開く
2. アドレスバーに勤怠管理システムのURL（セットアップ時に確認したURL）を入力
3. 手動で出社・退社時間を入力

---

### Q2: 複数のPCで使いたい場合は？

**A:** 各PCのスタートアップフォルダにそれぞれ配置してください：
1. 各PCでセットアップステップを実行
2. URL設定は全PC同じでも問題ありません

---

### Q3: 自宅から接続したい場合は？

**A:** 以下の方法をお試しください：
1. **VPN接続を使用：**
   - 自宅PCを会社のVPN接続に繋ぐ
   - その後、バッチを実行
   - バッチはVPN接続後に自動実行されるよう設定

2. **リモートアクセス環境がある場合：**
   - リモートアクセスシステムにログイン後、バッチ実行

---

### Q4: URLにパスワードを埋め込めますか？

**A:** 技術的には可能ですが、**セキュリティ上の理由から非推奨**です：
1. バッチファイル内にパスワードが平文で保存される
2. ファイルが盗まれると、パスワードが漏洩する

**推奨方法：**
- URLはパスワードなしで開く
- ブラウザのログイン画面でユーザー名とパスワードを入力

---

### Q5: 別のシステム（給与管理など）も同時に開きたい

**A:** バッチファイルを複数用意し、各スタートアップに配置：
1. `open-attendance.bat` （勤怠管理システム用）
2. `open-salary.bat` （給与管理システム用）
3. 各々のスタートアップフォルダに配置

複数起動できます

---

### Q6: バッチ実行時に別のウィンドウでブラウザを起動したい

**A:** バッチの`:OPEN_BROWSER`セクションを以下のように編集：
```batch
:OPEN_BROWSER
REM 新しいウィンドウでURL起動
start "" /new %ATTENDANCE_URL%
```

---

### Q7: ユーザー名などの個人情報がコマンドプロンプトに表示される。本当に大丈夫？

**A:** はい、問題ありません：
1. `query user`コマンドはローカルマシンのセッション情報のみ取得
2. ネットワーク上に送信されない
3. 自分のマシン上の情報なので、セキュリティリスクなし
4. 詳細は IT部門に相談してください

---

## サポート情報

### サポート連絡先

問題が解決しない場合は、以下の情報を添えてサポートに連絡してください：

| 項目 | 内容 |
|------|------|
| **連絡先** | IT部門 / ヘルプデスク |
| **電話** | [組織のサポート電話番号] |
| **メール** | [組織のサポートメールアドレス] |
| **営業時間** | [営業時間] |

### 報告時に含める情報

以下を含めると、サポート対応が迅速になります：

```
【報告内容】
- 問題の概要：[例: ブラウザが起動しない]
- エラーメッセージ：[表示されたメッセージをそのまま記入]

【環境情報】
- Windows バージョン：[例: Windows 11]
- OS ビルド番号：[Windowsメニュー → 設定 → システム で確認]
- インストール済みブラウザ：[Edge / Chrome 等]
- ネットワーク：[社内有線LAN / Wi-Fi 等]

【実施済み対応】
- これまでに試した対応：[例: デフォルトブラウザ設定確認済み]

【その他】
- 参考情報や画面ショット等
```

---

## 更新履歴

| バージョン | 作成日 | 更新内容 |
|----------|--------|--------|
| 1.0 | 2025-12-07 | 初版作成 |

---

## ライセンスと利用規約

このバッチファイルは社内利用のみを想定しており、個人的な利用や社外への配布は禁止です。

---

**作成日:** 2025-12-07  
**最終更新:** 2025-12-07  
**バージョン:** 1.0

ご不明な点がございましたら、IT部門またはサポートまでお問い合わせください。
