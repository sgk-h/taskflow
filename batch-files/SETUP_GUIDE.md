# 勤怠管理システム自動起動バッチ セットアップ手順書

## 概要
このドキュメントでは、`open-attendance.bat`をWindows環境のスタートアップフォルダに配置し、端末起動時に勤怠管理システムを自動表示するための手順を説明します。

---

## セットアップ手順

### ステップ1: バッチファイルの準備

1. `open-attendance.bat`ファイルをテキストエディタで開きます
2. 16行目の以下の部分を編集します：
   ```batch
   set ATTENDANCE_URL=https://company.example.com/attendance
   ```
3. `https://company.example.com/attendance`を貴社の勤怠管理システムの実際のURLに置き換えます
   - 例：`set ATTENDANCE_URL=https://hr.company.jp/attendance`
4. ファイルを**Shift-JIS形式**または**UTF-8 BOM形式**で保存します

### ステップ2: スタートアップフォルダへの配置

#### 方法A: ファイルエクスプローラーで配置（推奨）

1. **スタートアップフォルダを開く**
   - `Win + R`キーを押して「ファイル名を指定して実行」を開く
   - `shell:startup`と入力してEnterキーを押す
   - スタートアップフォルダが開きます

2. **バッチファイルをコピー**
   - `open-attendance.bat`ファイルをコピー（Ctrl+C）
   - スタートアップフォルダ内に貼り付け（Ctrl+V）

#### 方法B: 手動で配置

1. 以下のパスをファイルエクスプローラーのアドレスバーに入力
   ```
   C:\Users\{ユーザー名}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
   ```
   - `{ユーザー名}`は実際のWindowsユーザー名に置き換え（例：`C:\Users\user01\...`）

2. `open-attendance.bat`ファイルをこのフォルダにコピー

### ステップ3: 動作確認

1. **手動実行による確認**
   - `open-attendance.bat`をダブルクリックで実行
   - 以下の画面が表示されることを確認：
     ```
     =====================================
       勤怠管理システム自動起動
     =====================================
     
     【ログイン情報】
     USERNAME    SESSIONNAME    ID  STATE
     {ユーザー名}  console        0   アクティブ
     
     【ブラウザ起動】
     ブラウザで以下のURLを開いています...
     https://company.example.com/attendance
     ```
   - デフォルトブラウザで勤怠管理システムが開く
   - EnterキーでコマンドプロンプトウィンドウとURLを閉じる

2. **スタートアップ自動実行の確認**
   - Windowsを再起動
   - ログイン後、自動的にコマンドプロンプトが起動し、バッチが実行される
   - 勤怠管理システムのURLが自動的にブラウザで開く

---

## トラブルシューティング

### 問題1: 「ユーザー情報の取得に失敗しました」と表示される

**原因:** `query user`コマンドが正常に実行されていない

**対応：**
- Windowsの権限設定を確認（通常ユーザー権限では実行可能）
- ドメイン環境の場合、ドメイン管理者に相談してください

### 問題2: ブラウザが起動しない

**原因:** 
- デフォルトブラウザが設定されていない
- URLの設定が間違っている

**対応：**
1. バッチファイルのURL設定を確認（ステップ1を確認）
2. Windows設定でデフォルトブラウザを設定：
   - 「設定」→「アプリ」→「デフォルトアプリ」
   - 「ブラウザ」の項目から希望のブラウザを選択

### 問題3: 日本語が文字化けして表示される

**原因:** ファイルの文字コード設定が間違っている

**対応：**
- バッチファイルを以下の形式で保存し直す：
  - **Shift-JIS**（推奨、Windows標準）
  - または **UTF-8 BOM**

### 問題4: スタートアップ時に自動実行されない

**原因:**
- ファイルがスタートアップフォルダに正しく配置されていない
- ファイル名が変更されている

**対応：**
1. スタートアップフォルダを再度確認（ステップ2参照）
2. ファイル名が`open-attendance.bat`のままか確認
3. 管理者権限が必要な場合は、ショートカットのプロパティで「管理者として実行」を設定

---

## カスタマイズ方法

### URLを変更したい

バッチファイルの16行目を編集：
```batch
set ATTENDANCE_URL=https://新しいURL
```

### ブラウザウィンドウのサイズを指定したい

`:OPEN_BROWSER`セクションの`start`コマンドをカスタマイズ：
```batch
REM 通常（デフォルト）
start "" %ATTENDANCE_URL%

REM 最大化ウィンドウで開きたい場合
start "" /max %ATTENDANCE_URL%

REM 最小化ウィンドウで開きたい場合
start "" /min %ATTENDANCE_URL%
```

### タイトルバーの日本語を変更したい

バッチファイルの21行目を編集：
```batch
title 新しいタイトル
```

---

## セキュリティに関する注意事項

1. **ファイル配置先の確認**
   - スタートアップフォルダは個人用ユーザーフォルダ内に配置されます
   - 他ユーザーには自動実行されません

2. **URL情報の保護**
   - バッチファイルには社内勤怠管理システムのURLが記載されます
   - 社外への持ち出しには注意してください

3. **実行権限**
   - 通常ユーザー権限で実行可能（管理者権限不要）
   - セキュリティポリシーによっては、実行ポリシーを確認してください

---

## よくある質問（FAQ）

**Q1: 複数のPC（自宅、会社等）で使いたい場合は？**

A: 各PCのスタートアップフォルダにそれぞれ配置してください。URLは共通でも問題ありません。

**Q2: URLをパスワード保護されたサイトにしたい場合は？**

A: バッチファイル起動後、ブラウザのログイン画面でユーザー名とパスワードを入力してください。
（URLにはパスワードを埋め込まないことをお勧めします）

**Q3: バッチが起動しないようにしたい場合は？**

A: スタートアップフォルダから`open-attendance.bat`ファイルを削除してください。

---

## サポート情報

問題が解決しない場合は、以下の情報を添えてサポートに連絡してください：

- Windows バージョン（Windows 10 / 11等）
- エラーメッセージの内容
- バッチファイル内のURL設定
- デフォルトブラウザの種類

---

**作成日:** 2025-12-07  
**バージョン:** 1.0
