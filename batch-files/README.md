# 勤怠管理システム自動起動バッチ

## 概要

このプロジェクトは、Windows端末の起動時に勤怠管理システムを自動的にブラウザで表示するバッチファイルとドキュメントセットです。

組織内のユーザーが端末起動後、強制的に勤怠管理システムが表示されることで、日々の勤怠入力漏れを防止します。

---

## プロジェクト構成

```
batch-files/
├── open-attendance.bat          # メインバッチファイル
├── SETUP_GUIDE.md               # セットアップ手順書（管理者向け）
├── USER_MANUAL.md               # ユーザーマニュアル（ユーザー向け）
├── TEST_PLAN.md                 # テスト計画書
└── README.md                    # このファイル
```

---

## ファイル説明

### 1. `open-attendance.bat` （メインバッチファイル）

**説明:**
- Windows スタートアップで自動実行されるバッチファイル
- 勤怠管理システムのURLをブラウザで開く
- ログイン時間をコマンドプロンプトに表示

**主な機能:**
- ヘッダー・タイトル表示
- `query user`コマンドによるログイン情報表示
- `start`コマンドによるブラウザ自動起動
- エラーハンドリング（URL未設定、ブラウザ起動失敗等）

**ファイルサイズ:** 約2-3 KB

**使用可能なOS:** Windows 10 / Windows 11

---

### 2. `SETUP_GUIDE.md` （セットアップ手順書）

**対象者:** システム管理者、IT部門スタッフ

**内容:**
- バッチファイルの準備方法
- スタートアップフォルダへの配置手順（2つの方法）
- 動作確認方法
- トラブルシューティング（基本的な対応）
- カスタマイズ方法（URL変更、ウィンドウサイズ指定等）

**ページ数:** 約4-5 ページ

---

### 3. `USER_MANUAL.md` （ユーザーマニュアル）

**対象者:** 組織内のエンドユーザー

**内容:**
- システム概要と利点
- セットアップ手順（5ステップ）
- 使用方法
- 詳細なトラブルシューティング
- FAQ（7問）
- サポート連絡先

**ページ数:** 約8-10 ページ

---

### 4. `TEST_PLAN.md` （テスト計画書）

**対象者:** QA/テスト担当者

**内容:**
- テスト環境構成
- 13個のテストケース詳細
  - **正常系（6項目）:** TC-01～TC-06
  - **異常系（4項目）:** TC-07～TC-10
  - **エッジケース（3項目）:** TC-11～TC-13
- テスト実行手順
- 合格基準
- テスト結果記録用サマリーシート

**ページ数:** 約10-12 ページ

---

## プロジェクト概要（全フェーズ）

### フェーズ1: 検討・企画 ✅ 完了

**成果物:**
- 要件定義の詳細化
- 環境・技術的検討
- リスク評価と対策

---

### フェーズ2: 外部設計 ✅ 完了

**成果物:**
- ファイル仕様定義
- UIフォーマット設計
- 入出力仕様定義

---

### フェーズ3: 内部設計 ✅ 完了

**成果物:**
- 処理フロー設計
- 変数設計
- ラベル・サブルーチン設計
- エラーハンドリング設計

---

### フェーズ4: 製造・実装 ✅ 完了

**成果物:**
1. **`open-attendance.bat`** - メインバッチファイル（約80行）
2. **`SETUP_GUIDE.md`** - セットアップ手順書
3. **`USER_MANUAL.md`** - ユーザーマニュアル
4. **`TEST_PLAN.md`** - テスト計画書

**実装の特徴:**
- シンプルで保守性の高いコード
- 日本語対応（文字コード：Shift-JIS または UTF-8 BOM）
- 充実したエラーハンドリング
- コメント記述で明確な説明

---

### フェーズ5: テスト （実施予定）

**テスト計画:**
- 正常系テスト：6項目
- 異常系テスト：4項目
- エッジケーステスト：3項目
- **合計13個のテストケース**

**合格基準:**
- TC-01～TC-06が全て合格で本番適用OK
- TC-07～TC-10で最低1項目合格で条件付き適用可

**テスト実施方法:**
詳細は[TEST_PLAN.md](TEST_PLAN.md)を参照

---

## 導入フロー（ユーザー向け）

```
【初回設定】
1. IT部門から open-attendance.bat を受け取る
   ↓
2. バッチファイルでURL設定（勤怠管理システムURL）
   ↓
3. スタートアップフォルダに配置（shell:startup）
   ↓
4. 手動実行で動作確認
   ↓
5. Windows再起動で自動実行確認
   ↓
【完了】毎日の自動実行開始
   ↓
6. 以降、毎日のWindows起動時に自動実行
```

---

## 導入フロー（管理者向け）

```
【社内展開準備】
1. open-attendance.bat の URL確認・修正
2. テスト環境（仮想マシン）での検証
   ↓
【テスト実行】
3. TEST_PLAN.md に基づき、TC-01～TC-13実行
4. 全テストケース合格を確認
   ↓
【配布準備】
5. ユーザー向けに SETUP_GUIDE.md / USER_MANUAL.md を準備
6. メール配信または社内ポータルで配布
   ↓
【運用開始】
7. 各ユーザーがセットアップ実施
8. サポート受付体制を確立
```

---

## 技術仕様

### バッチファイル技術

| 項目 | 仕様 |
|------|------|
| **ファイル形式** | Windows バッチファイル（.bat） |
| **文字コード** | Shift-JIS または UTF-8 BOM |
| **行数** | 約80行（コメント含む） |
| **サブルーチン** | 4個（SHOW_HEADER, SHOW_LOGIN_INFO, OPEN_BROWSER, SHOW_FOOTER） |
| **使用コマンド** | `chcp`, `setlocal`, `echo`, `query user`, `start`, `pause` |
| **エラーハンドリング** | `ERRORLEVEL`による条件分岐 |

### 配置場所

**個別ユーザー用（推奨）:**
```
C:\Users\{ユーザー名}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
```

**全体用（管理者権限必要）:**
```
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup
```

### 自動実行の仕組み

1. Windows起動 → ユーザーログイン
2. ログイン処理後、スタートアップフォルダ内のファイルが順次実行
3. `open-attendance.bat`が実行される
4. 勤怠管理システムのブラウザが自動で開く

---

## セキュリティ考慮事項

### 情報セキュリティ

| 項目 | 対応内容 |
|------|--------|
| **URL情報** | バッチファイル内に平文で記載（社内利用のみ） |
| **パスワード** | URLに埋め込まない（ブラウザログイン画面で入力） |
| **ユーザー情報** | `query user`は ローカルシステムのセッション情報のみ（ネットワーク送信なし） |
| **ファイルアクセス** | 個別ユーザーのスタートアップフォルダに配置（他ユーザーアクセス不可） |

### 実行権限

- **管理者権限：** 不要
- **ユーザー権限：** スタートアップフォルダへのファイルコピー権限のみ必要

---

## トラブルシューティング（クイックリファレンス）

| 症状 | 原因 | 対応 |
|------|------|------|
| バッチが自動実行されない | スタートアップフォルダに配置されていない | `shell:startup`で再度配置 |
| ブラウザが起動しない | デフォルトブラウザ未設定 | 設定→アプリ→デフォルトアプリで設定 |
| 日本語が文字化けする | ファイル文字コード不正 | Shift-JIS または UTF-8 BOMで再保存 |
| ログイン情報が表示されない | query user 権限問題 | ドメイン管理者に相談 |

詳細は[USER_MANUAL.md](USER_MANUAL.md)を参照

---

## よくある質問（FAQ）

**Q: 複数のPCで使えますか？**  
A: はい。各PCのスタートアップフォルダに配置してください。

**Q: URLを変更したい場合は？**  
A: バッチファイルの16行目を編集してください。詳細は[SETUP_GUIDE.md](SETUP_GUIDE.md)参照。

**Q: 自動実行を止めたい場合は？**  
A: スタートアップフォルダから`open-attendance.bat`を削除してください。

**Q: パスワード保護されたURLでも動きますか？**  
A: はい。ブラウザで開いた後、ログイン画面でパスワード入力してください。

詳細は[USER_MANUAL.md](USER_MANUAL.md)の[FAQ](#faq)セクションを参照

---

## サポート情報

### 問い合わせ先

- **セットアップ関連：** [IT部門連絡先]
- **技術的な質問：** [システム担当者連絡先]
- **トラブル報告：** [ヘルプデスク連絡先]

### 報告時の情報

以下を含めるとサポートが迅速です：

```
【報告内容】
- 問題の概要

【環境情報】
- Windows バージョン（例：Windows 11）
- インストール済みブラウザ

【エラーメッセージ】
- 表示されたメッセージ（スクリーンショット推奨）
```

---

## 更新履歴

| バージョン | 日付 | 更新内容 |
|-----------|------|--------|
| 1.0 | 2025-12-07 | 初版リリース |

---

## ドキュメント一覧

| ドキュメント | 対象者 | 内容 |
|----------|--------|------|
| `open-attendance.bat` | 全員 | メインバッチファイル |
| `SETUP_GUIDE.md` | 管理者・IT部門 | セットアップ手順（約5ページ） |
| `USER_MANUAL.md` | エンドユーザー | 使用方法・FAQ（約10ページ） |
| `TEST_PLAN.md` | QA・テスト担当 | テスト計画・13個のテストケース（約12ページ） |
| `README.md` | 全員 | このファイル（概要） |

---

## ライセンスと利用規約

このプロジェクトは組織内利用のみを想定しており、個人的な利用や社外への配布は禁止です。

---

## 関連リンク

- [Microsoft Windows commands - start](https://learn.microsoft.com/windows-server/administration/windows-commands/start)
- [Microsoft Windows commands - query user](https://learn.microsoft.com/windows-server/administration/windows-commands/query-user)

---

**プロジェクト開始日:** 2025-12-07  
**バージョン:** 1.0  
**ステータス:** 製造完了（フェーズ5テスト実施予定）

---

## 次のステップ

1. **テスト実施（フェーズ5）**
   - Windows環境でTC-01～TC-13を実行
   - テスト結果を[TEST_PLAN.md](TEST_PLAN.md)に記録

2. **本番導入**
   - テスト全項目合格後、ユーザーに配布
   - SETUP_GUIDE.md / USER_MANUAL.mdを配布

3. **運用開始**
   - サポート受付体制の確立
   - 定期的な保守

---

ご不明な点がございましたら、IT部門またはシステム管理者までお問い合わせください。
